!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){"use strict";var r=document.querySelector(".notify");document.querySelector(".notify__button").addEventListener("click",function(){r.classList.add("visually-hidden")}),e.exports={show:function(e){r.classList.remove("visually-hidden"),r.querySelector(".notify__message").innerHTML=e}}},function(e,t,n){"use strict";n(2),n(3),n(4),n(5),n(6),n(7),n(8),n(9),n(10)},function(e,t,n){"use strict";var r=document.getElementById("contacts-map"),o=document.getElementById("modal-shadow"),i=document.querySelector(".map .modal__close"),c=document.querySelector(".map.modal");e.exports=void(document.getElementById("contacts-map")&&(r.addEventListener("click",function(){c.classList.remove("visually-hidden"),o.classList.remove("visually-hidden")}),i.addEventListener("click",function(){c.classList.add("visually-hidden"),o.classList.add("visually-hidden")})))},function(e,t,n){"use strict";var r=document.querySelector('.main-nav__link[href="/user/signin"]');e.exports=function(){if(r){var e=document.querySelector(".modal.signin"),t=document.getElementById("modal-shadow"),n=e.querySelector(".signin__form"),o=n.querySelector(".informer");r.addEventListener("click",function(n){n.preventDefault(),e.classList.remove("visually-hidden"),t.classList.remove("visually-hidden")}),n.addEventListener("submit",function(e){e.preventDefault();var t=new FormData(e.target);fetch("/user/signin",{method:"POST",body:t}).then(function(e){e.status>=400&&(o.innerHTML="Ошибка на сервере"),422!==e.status&&401!==e.status||(o.innerHTML="Неверно введены данные"),e.redirected&&e.ok&&location.replace(e.url)})})}}()},function(e,t,n){"use strict";var r=document.querySelector(".signup"),o=document.querySelector('.main-nav__link[href="/user/signup"'),i=n(0);e.exports=function(){if(r&&o){var e=document.querySelector(".modal.signup"),t=document.getElementById("modal-shadow"),n=e.querySelector(".signup__form"),c=r.querySelector(".informer");o.addEventListener("click",function(n){n.preventDefault(),e.classList.remove("visually-hidden"),t.classList.remove("visually-hidden")}),n.addEventListener("submit",function(n){n.preventDefault();var r=new FormData(n.target);if(r.get("password")!==r.get("repassword"))return c.classList.remove("informer--green"),void(c.innerHTML="Пароли не совпадают");fetch("/user/signup",{method:"POST",body:r}).then(function(n){n.ok?(e.classList.add("visually-hidden"),t.classList.add("visually-hidden"),i.show("Вы успешно зарегистрировались! Теперь вы можете войти на сайт.")):422===n.status&&n.json().then(function(e){var t=e.errors.map(function(e){return Object.values(e.constraints).join(", ")});c.classList.remove("informer--green"),c.innerHTML=t})})})}}()},function(e,t,n){"use strict";var r=document.querySelector(".profile");e.exports=function(){if(r){var e=r.querySelector(".profile__form"),t=r.querySelector(".informer");e.addEventListener("submit",function(e){e.preventDefault();var n=new FormData(e.target);if(n.get("password")!==n.get("repassword"))return t.classList.remove("informer--green"),void(t.innerHTML="Пароли не совпадают");n.get("password")||n.delete("password"),n.delete("repassword"),fetch("/user/profile",{method:"PUT",body:n}).then(function(e){e.ok?(t.classList.add("informer--green"),t.innerHTML="Запись выполнена!"):422===e.status&&e.json().then(function(e){var n=e.errors.map(function(e){return Object.values(e.constraints).join(", ")});t.classList.remove("informer--green"),t.innerHTML=n})})})}}()},function(e,t,n){"use strict";var r=document.querySelectorAll(".schedule");e.exports=void(document.querySelector(".schedule")&&r.forEach(function(e){e.querySelectorAll(".checkbox-my").forEach(function(t){t.addEventListener("click",function(n){n.preventDefault();var r=t.dataset.id;t.querySelector(".checkbox-my__marker").classList.toggle("visually-hidden"),e.querySelectorAll('.schedule__mark[data-id="'+r+'"]').forEach(function(e){e.querySelector("span").classList.toggle("visually-hidden")})})})}))},function(e,t,n){"use strict";var r=document.querySelectorAll(".modal"),o=document.getElementById("modal-shadow"),i=document.querySelectorAll(".modal__close");e.exports=function(){function e(){o.classList.contains("visually-hidden")||(o.classList.add("visually-hidden"),r.forEach(function(e){e.classList.add("visually-hidden")}))}o.addEventListener("click",function(){e()}),i.forEach(function(t){t.addEventListener("click",function(){e()})})}()},function(e,t,n){"use strict";var r=document.querySelectorAll(".item-price__button"),o=document.querySelector(".catalog__basket-btn");function i(){var e=c().length;o.innerHTML="Корзина ("+e+")"}function c(){var e=localStorage.getItem("order");return e&&"undefined"!==e?JSON.parse(e):[]}e.exports=(o&&i(),void(r&&r.forEach(function(e){e.addEventListener("click",function(t){(function(e){var t=new Headers;return t.append("Accept","application/json"),fetch("/shop/product/"+e,{method:"GET",headers:t})})(e.dataset.productId).then(function(e){return e.json()}).then(function(e){!function(e){var t={id:e.id,prod_title:e.title,prod_properties:e.properties,total:e.price,count:1,price:e.price};if(!function(e){return c().some(function(t){return t.id===e.id})}(t)){var n=c();n.push(t),localStorage.setItem("order",JSON.stringify(n))}}(e),i(),o.classList.add("catalog__basket-btn--add"),setTimeout(function(){o.classList.remove("catalog__basket-btn--add")},300)})})})))},function(e,t,n){"use strict";var r=document.getElementById("new-order"),o=document.querySelector(".order__remove-btn"),i=document.querySelector(".order__place-btn"),c=n(0);function a(){var e=s(),t=["prod_title","total","count"],n=r?r.querySelector(".order__list"):null,o=document.createElement("table"),i=document.createElement("thead"),c=document.createElement("tr"),a=document.createElement("td");o.classList.add("order__list"),c.classList.add("order__head");var u=["наименование","стоимость","количество"].map(function(e){return(a=a.cloneNode(!0)).innerHTML=e,a});if(c.append.apply(c,function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(u)),i.append(c),o.append(i),e){var l=document.createElement("tbody");e.forEach(function(e){var n=document.createElement("tr");for(var r in n.classList.add("order__item"),n.dataset.productId=e.id,e)if(-1!==t.indexOf(r)){var o="",i=document.createElement("td");switch(r){case"prod_title":console.log(e.prod_properties);var c=e.prod_properties.map(function(e){return e.description}).join(", ");o=e.prod_title+(c?" ("+c+")":"");break;case"total":o=e.price*e.count+" р";break;case"count":var a=document.createElement("span");a.classList.add("order__count"),a.innerHTML=e[r],i.append(a),d(i,e);break;default:o=e[r]}i.append(o),n.append(i)}l.append(n)}),o.append(l)}else{var f=document.createElement("tbody");f.innerHTML='<tr class="order__void-basket"><td colspan="'+t.length+'">корзина пустая</td></tr>',o.append(f)}n&&n.replaceWith(o)}function d(e,t){var n=document.createElement("span"),r=document.createElement("span"),o=s();n.classList.add("inc-btn"),r.classList.add("dec-btn"),n.addEventListener("click",function(){o.forEach(function(e){e.id===t.id&&(e.count=+e.count+1,e.total=+e.count*+e.price)}),localStorage.setItem("order",JSON.stringify(o)),a()}),r.addEventListener("click",function(){o.forEach(function(e){e.id===t.id&&(e.count=+e.count>0?+e.count-1:0,e.total=+e.count*+e.price)}),localStorage.setItem("order",JSON.stringify(o)),a()}),e.prepend(r),e.append(n)}function s(){var e=localStorage.getItem("order");return JSON.parse(e)}e.exports=function(){if(a(),o&&o.addEventListener("click",function(){localStorage.removeItem("order"),a()}),i){var e=document.querySelector(".modal.send-order"),t=document.getElementById("modal-shadow"),n=e.querySelector(".send-order__form"),d=r.querySelector(".informer");i.addEventListener("click",function(n){n.preventDefault(),localStorage.getItem("order")?(e.classList.remove("visually-hidden"),t.classList.remove("visually-hidden")):d.innerHTML="Корзина пустая!"}),n.addEventListener("submit",function(n){n.preventDefault();var r=new FormData(n.target);r.append("order",localStorage.getItem("order")),r&&fetch("/shop/order/place",{method:"POST",body:r}).then(function(n){!n.redirected&&n.ok?(e.classList.add("visually-hidden"),t.classList.add("visually-hidden"),c.show("Заказ отправлен! Ма свяжемся с вами в ближайшеее время.")):n.redirected&&location.replace(n.url),localStorage.removeItem("order"),a()})})}}()},function(e,t,n){"use strict";var r=n(0),o=document.querySelector(".appointment");e.exports=void(o&&o.querySelector(".appointment__form").addEventListener("submit",function(e){e.preventDefault();var t=new FormData(e.target);fetch("/appointment",{method:"POST",body:t}).then(function(e){e.ok&&r.show("Запись отправлена! Мы с вами свяжемся в ближайшее время .")})}))}]);