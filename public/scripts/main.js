!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n(1),n(2),n(3),n(4),n(5),n(6),n(7),n(8),n(9)},function(e,t,n){"use strict";var r=document.getElementById("contacts-map"),o=document.getElementById("modal-shadow"),c=document.querySelector(".map .modal__close"),a=document.querySelector(".map.modal");e.exports=void(document.getElementById("contacts-map")&&(r.addEventListener("click",function(){a.classList.remove("visually-hidden"),o.classList.remove("visually-hidden")}),c.addEventListener("click",function(){a.classList.add("visually-hidden"),o.classList.add("visually-hidden")})))},function(e,t,n){"use strict";var r=document.querySelector('.main-nav__link[href="/user/login"]');e.exports=function(){if(r){var e=document.querySelector(".modal.login"),t=document.getElementById("modal-shadow"),n=e.querySelector(".login__form"),o=n.querySelector(".informer");r.addEventListener("click",function(n){n.preventDefault(),e.classList.remove("visually-hidden"),t.classList.remove("visually-hidden")}),n.addEventListener("submit",function(e){e.preventDefault();var t=new FormData(e.target);fetch("/user/login",{method:"POST",body:t}).then(function(e){e.redirected&&e.ok?location.replace(e.url):o.innerHTML="Неверно введены данные"})})}}()},function(e,t,n){"use strict";var r=document.querySelector(".registration"),o=document.querySelector('.main-nav__link[href="/user/registration"'),c=n(10);e.exports=function(){if(r&&o){var e=document.querySelector(".modal.registration"),t=document.getElementById("modal-shadow"),n=e.querySelector(".registration__form"),a=r.querySelector(".informer");o.addEventListener("click",function(n){n.preventDefault(),e.classList.remove("visually-hidden"),t.classList.remove("visually-hidden")}),n.addEventListener("submit",function(e){e.preventDefault();var t=new FormData(e.target);fetch("/user/registration",{method:"POST",body:t}).then(function(e){e.ok?c.show("Вы успешно зарегистрировались! Теперь вы можете войти на сайт."):422===e.status&&e.json().then(function(e){var t=[];e.errors.forEach(function(e){t.push(e.msg)}),a.classList.remove("informer--green"),a.innerHTML=t.join(", ")})})})}}()},function(e,t,n){"use strict";var r=document.querySelector(".profile");e.exports=function(){if(r){var e=r.querySelector(".profile__form"),t=r.querySelector(".informer");e.addEventListener("submit",function(e){e.preventDefault();var n=new FormData(e.target);""===n.get("password")&&(n.delete("password"),n.delete("repassword")),fetch("/user/profile",{method:"PUT",body:n}).then(function(e){e.ok?(t.classList.add("informer--green"),t.innerHTML="Запись выполнена!"):422===e.status&&e.json().then(function(e){var n=[];e.errors.forEach(function(e){n.push(e.msg)}),t.classList.remove("informer--green"),t.innerHTML=n.join(", ")})})})}}()},function(e,t,n){"use strict";var r=document.querySelectorAll(".schedule");e.exports=void(document.querySelector(".schedule")&&r.forEach(function(e){e.querySelectorAll(".checkbox-my").forEach(function(t){t.addEventListener("click",function(n){n.preventDefault();var r=t.dataset.id;t.querySelector(".checkbox-my__marker").classList.toggle("visually-hidden"),e.querySelectorAll('.schedule__mark[data-id="'+r+'"]').forEach(function(e){e.querySelector("span").classList.toggle("visually-hidden")})})})}))},function(e,t,n){"use strict";var r=document.querySelectorAll(".modal"),o=document.getElementById("modal-shadow"),c=document.querySelectorAll(".modal__close");e.exports=function(){function e(){o.classList.contains("visually-hidden")||(o.classList.add("visually-hidden"),r.forEach(function(e){e.classList.add("visually-hidden")}))}o.addEventListener("click",function(){e()}),c.forEach(function(t){t.addEventListener("click",function(){e()})})}()},function(e,t,n){"use strict";var r=document.querySelectorAll(".item-price__button"),o=document.querySelector(".catalog__basket-btn");function c(){var e=a().length;o.innerHTML="Корзина ("+e+")"}function a(){var e=localStorage.getItem("order");return e&&"undefined"!==e?JSON.parse(e):[]}e.exports=(o&&c(),void(r&&r.forEach(function(e){e.addEventListener("click",function(t){(function(e){var t=new Headers;return t.append("Accept","application/json"),fetch("/shop/product/"+e,{method:"GET",headers:t})})(e.dataset.productId).then(function(e){return e.json()}).then(function(e){!function(e){var t={id:e.id,prod_title:e.prod_title,prod_taste:e.prod_taste,total:e.price,count:1,price:e.price};if(!function(e){return a().some(function(t){return t.id===e.id})}(t)){var n=a();n.push(t),localStorage.setItem("order",JSON.stringify(n))}}(e),c(),o.classList.add("catalog__basket-btn--add"),setTimeout(function(){o.classList.remove("catalog__basket-btn--add")},300)})})})))},function(e,t,n){"use strict";var r=document.getElementById("new-order"),o=document.querySelector(".order__remove-btn"),c=document.querySelector(".order__place-btn"),a=n(10);function i(){var e=s(),t=["prod_title","total","count"],n=r?r.querySelector(".order__list"):null,o=document.createElement("table"),c=document.createElement("thead"),a=document.createElement("tr"),i=document.createElement("td");o.classList.add("order__list"),a.classList.add("order__head");var l=["наименование","стоимость","количество"].map(function(e){return(i=i.cloneNode(!0)).innerHTML=e,i});if(a.append.apply(a,function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(l)),c.append(a),o.append(c),e){var u=document.createElement("tbody");e.forEach(function(e){var n=document.createElement("tr");for(var r in n.classList.add("order__item"),n.dataset.productId=e.id,e)if(-1!==t.indexOf(r)){var o="",c=document.createElement("td");switch(r){case"prod_title":o=e.prod_title+(e.prod_taste?" ("+e.prod_taste+")":"");break;case"total":o=e.price*e.count+" р";break;case"count":var a=document.createElement("span");a.classList.add("order__count"),a.innerHTML=e[r],c.append(a),d(c,e);break;default:o=e[r]}c.append(o),n.append(c)}u.append(n)}),o.append(u)}else{var f=document.createElement("tbody");f.innerHTML='<tr class="order__void-basket"><td colspan="'+t.length+'">корзина пустая</td></tr>',o.append(f)}n&&n.replaceWith(o)}function d(e,t){var n=document.createElement("span"),r=document.createElement("span"),o=s();n.classList.add("inc-btn"),r.classList.add("dec-btn"),n.addEventListener("click",function(){o.forEach(function(e){e.id===t.id&&(e.count=+e.count+1,e.total=+e.count*+e.price)}),localStorage.setItem("order",JSON.stringify(o)),i()}),r.addEventListener("click",function(){o.forEach(function(e){e.id===t.id&&(e.count=+e.count>0?+e.count-1:0,e.total=+e.count*+e.price)}),localStorage.setItem("order",JSON.stringify(o)),i()}),e.prepend(r),e.append(n)}function s(){var e=localStorage.getItem("order");return JSON.parse(e)}e.exports=function(){if(i(),o&&o.addEventListener("click",function(){localStorage.removeItem("order"),i()}),c){var e=document.querySelector(".modal.send-order"),t=document.getElementById("modal-shadow"),n=e.querySelector(".send-order__form"),d=r.querySelector(".informer");c.addEventListener("click",function(n){n.preventDefault(),localStorage.getItem("order")?(e.classList.remove("visually-hidden"),t.classList.remove("visually-hidden")):d.innerHTML="Корзина пустая!"}),n.addEventListener("submit",function(n){n.preventDefault();var r=new FormData(n.target);r.append("order",localStorage.getItem("order")),r&&fetch("/shop/order/place",{method:"POST",body:r}).then(function(n){!n.redirected&&n.ok?(e.classList.add("visually-hidden"),t.classList.add("visually-hidden"),a.show("Заказ отправлен! Ма свяжемся с вами в ближайшеее время.")):n.redirected&&location.replace(n.url),localStorage.removeItem("order"),i()})})}}()},function(e,t,n){"use strict";var r=n(10),o=document.querySelector(".appointment");e.exports=void(o&&o.querySelector(".appointment__form").addEventListener("submit",function(e){e.preventDefault();var t=new FormData(e.target);fetch("/appointment",{method:"POST",body:t}).then(function(e){e.ok&&r.show("Запись отправлена! Мы с вами свяжемся в ближайшее время .")})}))},function(e,t,n){"use strict";var r=document.querySelector(".notify");document.querySelector(".notify__button").addEventListener("click",function(){r.classList.add("visually-hidden")}),e.exports={show:function(e){r.classList.remove("visually-hidden"),r.querySelector(".notify__message").innerHTML=e}}}]);