!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";r(1),r(2),r(3),r(4),r(5),r(6),r(7),r(8),r(9)},function(e,t,r){"use strict";var n=document.getElementById("contacts-map"),o=document.getElementById("modal-shadow"),c=document.querySelector(".map .modal__close"),a=document.querySelector(".map.modal");e.exports=void(document.getElementById("contacts-map")&&(n.addEventListener("click",function(){a.classList.remove("visually-hidden"),o.classList.remove("visually-hidden")}),c.addEventListener("click",function(){a.classList.add("visually-hidden"),o.classList.add("visually-hidden")})))},function(e,t,r){"use strict";var n=document.querySelector('.main-nav__link[href="/user/login"]');e.exports=function(){if(n){var e=document.querySelector(".modal.login"),t=document.getElementById("modal-shadow"),r=e.querySelector(".login__form"),o=r.querySelector(".informer");n.addEventListener("click",function(r){r.preventDefault(),e.classList.remove("visually-hidden"),t.classList.remove("visually-hidden")}),r.addEventListener("submit",function(e){e.preventDefault();var t=new FormData(e.target);fetch("/user/login",{method:"POST",body:t}).then(function(e){e.redirected&&e.ok?location.replace(e.url):o.innerHTML="Неверно введены данные"})})}}()},function(e,t,r){"use strict";var n=document.querySelector(".registration"),o=document.querySelector('.main-nav__link[href="/user/registration"');e.exports=function(){if(n&&o){var e=document.querySelector(".modal.registration"),t=document.getElementById("modal-shadow"),r=e.querySelector(".registration__form"),c=n.querySelector(".informer");o.addEventListener("click",function(r){r.preventDefault(),e.classList.remove("visually-hidden"),t.classList.remove("visually-hidden")}),r.addEventListener("submit",function(e){e.preventDefault();var t=new FormData(e.target);fetch("/user/registration",{method:"POST",body:t}).then(function(e){e.ok?(c.classList.add("informer--green"),c.innerHTML="Вы успешно зарегестрировались!"):422===e.status&&e.json().then(function(e){var t=[];e.errors.forEach(function(e){t.push(e.msg)}),c.classList.remove("informer--green"),c.innerHTML=t.join(", ")})})})}}()},function(e,t,r){"use strict";var n=document.querySelector(".profile");e.exports=function(){if(n){var e=n.querySelector(".profile__form"),t=n.querySelector(".informer");e.addEventListener("submit",function(e){e.preventDefault();var r=new FormData(e.target);""===r.get("password")&&(r.delete("password"),r.delete("repassword")),fetch("/user/profile",{method:"PUT",body:r}).then(function(e){e.ok?(t.classList.add("informer--green"),t.innerHTML="Запись отправлена!"):422===e.status&&e.json().then(function(e){var r=[];e.errors.forEach(function(e){r.push(e.msg)}),t.classList.remove("informer--green"),t.innerHTML=r.join(", ")})})})}}()},function(e,t,r){"use strict";var n=document.querySelectorAll(".schedule");e.exports=void(document.querySelector(".schedule")&&n.forEach(function(e){e.querySelectorAll(".checkbox-my").forEach(function(t){t.addEventListener("click",function(r){r.preventDefault();var n=t.dataset.id;t.querySelector(".checkbox-my__marker").classList.toggle("visually-hidden"),e.querySelectorAll('.schedule__mark[data-id="'+n+'"]').forEach(function(e){e.querySelector("span").classList.toggle("visually-hidden")})})})}))},function(e,t,r){"use strict";var n=document.querySelectorAll(".modal"),o=document.getElementById("modal-shadow"),c=document.querySelectorAll(".modal__close");e.exports=function(){function e(){o.classList.contains("visually-hidden")||(o.classList.add("visually-hidden"),n.forEach(function(e){e.classList.add("visually-hidden")}))}o.addEventListener("click",function(){e()}),c.forEach(function(t){t.addEventListener("click",function(){e()})})}()},function(e,t,r){"use strict";var n=document.querySelectorAll(".item-price__button"),o=document.querySelector(".catalog__basket-btn");function c(){var e=a().length;o.innerHTML="Корзина ("+e+")"}function a(){var e=localStorage.getItem("order");return e&&"undefined"!==e?JSON.parse(e):[]}e.exports=(o&&c(),void(n&&n.forEach(function(e){e.addEventListener("click",function(t){(function(e){var t=new Headers;return t.append("Accept","application/json"),fetch("/shop/product/"+e,{method:"GET",headers:t})})(e.dataset.productId).then(function(e){return e.json()}).then(function(e){!function(e){var t={id:e.id,prod_title:e.prod_title,prod_taste:e.prod_taste,total:e.price,count:1,price:e.price};if(!function(e){return a().some(function(t){return t.id===e.id})}(t)){var r=a();r.push(t),localStorage.setItem("order",JSON.stringify(r))}}(e),c()})})})))},function(e,t,r){"use strict";var n=document.getElementById("new-order"),o=document.querySelector(".order__remove-btn"),c=document.querySelector(".order__place-btn");function a(){var e=d(),t=["prod_title","total","count"],r=n?n.querySelector(".order__list"):null,o=document.createElement("table"),c=document.createElement("thead"),a=document.createElement("tr"),l=document.createElement("td");o.classList.add("order__list"),a.classList.add("order__head");var u=["наименование","стоимость","количество"].map(function(e){return(l=l.cloneNode(!0)).innerHTML=e,l});if(a.append.apply(a,function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}(u)),c.append(a),o.append(c),e){var s=document.createElement("tbody");e.forEach(function(e){var r=document.createElement("tr");for(var n in r.classList.add("order__item"),r.dataset.productId=e.id,e)if(-1!==t.indexOf(n)){var o="",c=document.createElement("td");switch(n){case"prod_title":o=e.prod_title+(e.prod_taste?" ("+e.prod_taste+")":"");break;case"total":o=e.price*e.count+" р";break;case"count":var a=document.createElement("span");a.classList.add("order__count"),a.innerHTML=e[n],c.append(a),i(c,e);break;default:o=e[n]}c.append(o),r.append(c)}s.append(r)}),o.append(s)}else{var f=document.createElement("tbody");f.innerHTML='<tr class="order__void-basket"><td colspan="'+t.length+'">корзина пустая</td></tr>',o.append(f)}r&&r.replaceWith(o)}function i(e,t){var r=document.createElement("span"),n=document.createElement("span"),o=d();r.classList.add("inc-btn"),n.classList.add("dec-btn"),r.addEventListener("click",function(){o.forEach(function(e){e.id===t.id&&(e.count=+e.count+1,e.total=+e.count*+e.price)}),localStorage.setItem("order",JSON.stringify(o)),a()}),n.addEventListener("click",function(){o.forEach(function(e){e.id===t.id&&(e.count=+e.count>0?+e.count-1:0,e.total=+e.count*+e.price)}),localStorage.setItem("order",JSON.stringify(o)),a()}),e.prepend(n),e.append(r)}function d(){var e=localStorage.getItem("order");return JSON.parse(e)}e.exports=function(){if(a(),o&&o.addEventListener("click",function(){localStorage.removeItem("order"),a()}),c){var e=document.querySelector(".modal.send-order"),t=document.getElementById("modal-shadow"),r=e.querySelector(".send-order__form"),i=n.querySelector(".informer");c.addEventListener("click",function(r){r.preventDefault(),localStorage.getItem("order")?(e.classList.remove("visually-hidden"),t.classList.remove("visually-hidden")):i.innerHTML="Корзина пустая!"}),r.addEventListener("submit",function(r){r.preventDefault();var n=new FormData(r.target);n.append("order",localStorage.getItem("order")),n&&fetch("/shop/order/place",{method:"POST",body:n}).then(function(r){!r.redirected&&r.ok?(e.classList.add("visually-hidden"),t.classList.add("visually-hidden"),i.classList.add("informer--green"),i.innerHTML="Заказ отправлен!"):r.redirected&&location.replace(r.url),localStorage.removeItem("order"),a()})})}}()},function(e,t,r){"use strict";var n=document.querySelector(".appointment");e.exports=function(){if(n){var e=n.querySelector(".appointment__form"),t=n.querySelector(".informer");e.addEventListener("submit",function(e){e.preventDefault();var r=new FormData(e.target);fetch("/appointment",{method:"POST",body:r}).then(function(e){e.ok&&(t.classList.add("informer--green"),t.innerHTML="Запись отправлена!")})})}}()}]);